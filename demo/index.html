<!DOCTYPE html>
<head>
  <script>
    function loadAnalytics() {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.setAttribute("async", "true");
      script.setAttribute("src", "https://www.googletagmanager.com/gtag/js?id=UA-165890546-1");
      document.documentElement.firstChild.appendChild(script);
    }

    if (document.location.host == 'gcode-preview.web.app') {
      loadAnalytics();

      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-165890546-1');
    }
  </script>
  <title>GCode Preview</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <canvas id="renderer" class="gcode-previewer"></canvas>

  <div class="dnd">☝️ Drop a gcode file here to view it</div>
  <div class="version-box">

    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="remcoder" data-color="#303030" data-emoji=""  data-font="Lato" data-text="Buy me a coffee" data-outline-color="#ffffff" data-font-color="#ffffff" data-coffee-color="#FFDD00" ></script>
</div>
  <div class="sidebar">
    <div>
      <h1>GCode Preview</h1>
      <section>
        <img id="thumb" title="thumbnail generated by slicer" />
        file <a id="file-name">loading..</a>
        <div><span id="layer-count"></span> / <span id="file-size"></span></div>
      </section>
      <section>
        <div class="controls">
          <label>End layer <output id="end-layer-value" ></output></label>&nbsp;<input
            type="range"
            min="1"
            value="0"
            id="end-layer"
          />
        </div>
        <div class="controls">
          <label>Start layer <output id="start-layer-value" ></output></label>&nbsp;<input
            type="range"
            min="1"
            value="1"
            id="start-layer"
          />
        </div>
        <div class="controls">
          <label>Line width <output id="line-width-value" ></output></label>&nbsp;<input
            type="range"
            min="1"
            max="50"
            value="1"
            id="line-width"
          />
        </div>
        <div class="controls">
          <label for="single-layer-mode">Single layer mode</label
          ><input type="checkbox" id="single-layer-mode" />
        </div>
        <div class="controls">
          <label for="extrusion">Extrusion</label
          ><input type="checkbox" id="extrusion" />
        </div>
        <div class="controls">
          <label for="render-tubes">Render tubes</label
          ><input type="checkbox" id="render-tubes" />
        </div>
      </section>

      <section class="extrusion-colors">
        <div class="flex just-between"># of extrusion colors  <div class="controls">
          <button id="add-color">+</button>
          <button id="remove-color">-</button>
        </div></div>
        <div class="controls">
          <label for="extrusion-color-t0">Extrusion color (T0)</label>
          <input type="color" id="extrusion-color-t0" value="#ff0000" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t1">Extrusion color (T1)</label>
          <input type="color" id="extrusion-color-t1" value="#00ff00" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t2">Extrusion color (T2)</label>
          <input type="color" id="extrusion-color-t2" value="#0000ff" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t3">Extrusion color (T3)</label>
          <input type="color" id="extrusion-color-t3" value="#ff00ff" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t4">Extrusion color (T4)</label>
          <input type="color" id="extrusion-color-t4" value="#00ffff" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t5">Extrusion color (T5)</label>
          <input type="color" id="extrusion-color-t5" value="#ffff00" />
        </div>
        <div class="controls">
          <label for="extrusion-color-t6">Extrusion color (T6)</label>
          <input type="color" id="extrusion-color-t6" value="#ff0000" />  
        </div>
        <div class="controls">
          <label for="extrusion-color-t7">Extrusion color (T7)</label>
          <input type="color" id="extrusion-color-t7" value="#00ff00" />
        </div>
      </section>

      <section>
        <div class="controls">
          <label for="travel">Travel</label
          ><input type="checkbox" id="travel" />
        </div>
        <div class="controls">
          <label for="travel-color">Travel color</label>
          <input type="color" id="travel-color" value="#0000ff" />
        </div>
        <div class="controls">
          <label for="highlight">Highlight top layer</label
          ><input type="checkbox" id="highlight" />
        </div>
        <div class="controls">
          <label for="top-layer-color">Top layer color</label>
          <input type="color" id="top-layer-color" value="#00ffff" />
        </div>
        <div class="controls">
          <label for="last-segment-color">Last segment color</label>
          <input type="color" id="last-segment-color" value="#ffffff" />
        </div>
        <div class="controls">
          <label for="background-color">Background color</label>
          <input type="color" id="background-color" value="#e0e0e0" />
        </div>
      </section>

      <section>
        <div  class="controls">
          <label for="drawBuildVolume">Draw build volume</label
          ><input type="checkbox" id="drawBuildVolume" checked />
        </div>
        <div class="controls">
          <label for="buildVolumeX">Build volume (x)&nbsp;</label
          ><input type="number" id="buildVolumeX" step=10 value=150 />
        </div>
        <div  class="controls">
          <label for="buildVolumeY">Build volume (y)&nbsp;</label
          ><input type="number" id="buildVolumeY" step=10 value=150 />
        </div>
        <div  class="controls">
          <label for="buildVolumeZ">Build volume (z)&nbsp;</label
          ><input type="number" id="buildVolumeZ" step=10 value=150 />
        </div>

      </section>
      <section>
        <button onclick="saveCameraPosition()">save camera</button>
        <button onclick="loadCameraPosition()">load camera</button>
      </section>
      <section style="display: none;">
        <button id=snapshot>Create snapshot</button>
      </section>

    </div>
    <div>
      <section>
        <div><a href="http://twitter.com/remcoder">@remcoder</a> ©2020 - 2024</div>

        <div>
          <a href="https://github.com/remcoder/gcode-preview">code</a> - MIT license
        </div>
      </section>
      <section>
        <a href="https://www.npmjs.com/package/gcode-preview">
          <img src="https://img.shields.io/npm/v/gcode-preview.svg?style=flat"/>
          </a>
      </section>
    </div>
  </div>

  <script src="js/three.min.js"></script>
  <script src="js/canvas2image.js"></script>
  <script src="js/gcode-preview.js"></script>
  <script src="js/demo.js"></script>
  <script>
    const gcodeDemo = initDemo();
    loadGCodeFromServer('square.gcode');
  </script>
</body>
